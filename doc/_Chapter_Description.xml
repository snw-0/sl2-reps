<?xml version="1.0" encoding="UTF-8"?>

<!-- This is an automatically generated file. -->
<Chapter Label="Chapter_Description">
<Heading>Description</Heading>

<P/>
The group <Math>\mathrm{SL}_2(\mathbb{Z})</Math> is generated by <Math>\mathfrak{s}</Math> = <Code>[[0,1],[-1,0]]</Code> and <Math>\mathfrak{t}</Math> = <Code>[[1,1],[0,1]]</Code> (which satisfy the relations <Math>\mathfrak{s}^4 = (\mathfrak{st})^3 = \mathrm{id}</Math>).
Thus, any complex representation <Math>\rho</Math> of <Math>\mathrm{SL}_2(\mathbb{Z})</Math> on <Math>\mathbb{C}^n</Math> (where <Math>n \in \mathbb{Z}^+</Math> is called the <Emph>degree</Emph> or <Emph>dimension</Emph> of <Math>\rho</Math>) is determined by the <Math>n \times n</Math> matrices <Math>S = \rho(\mathfrak{s})</Math> and <Math>T = \rho(\mathfrak{t})</Math>.
<P/>
This package constructs irreducible representations of <Math>\mathrm{SL}_2(\mathbb{Z})</Math> which factor through <Math>\mathrm{SL}_2(\mathbb{Z}/\ell\mathbb{Z})</Math> for some <Math>\ell \in \mathbb{Z}^+</Math>; the smallest such <Math>\ell</Math> is called the <Emph>level</Emph> of the representation, and is equal to the order of <Math>T</Math>. One may equivalently say that the kernel of the representation is a congruence subgroup.  Such representations are called <Emph>congruent</Emph> representations.  A congruent representation <Math>\rho</Math> is called <Emph>symmetric</Emph> if <Math>S = \rho(\mathfrak{s})</Math> is a symmetric, unitary matrix and <Math>T = \rho(\mathfrak{t})</Math> is a diagonal matrix; it was proved by the authors that every congruent representation is equivalent to a symmetric one (see <Ref Sect="Chapter_Description_Section_Construction_Subsection_S_and_T_matrices"/>).  Any representation of <Math>\mathrm{SL}_2(\mathbb{Z})</Math> arising from a modular tensor category is symmetric <Cite Key="DLN15"/>.
<P/>
We therefore present representations in the form of a record <Code>rec(S, T, degree, level, name)</Code>, where the name follows the conventions of <Cite Key="NW76"/>.
<P/>
Note that our definition of <Math>\mathfrak{s}</Math> follows that of <Cite Key="Nobs1"/>; other authors prefer the inverse, i.e. <Math>\mathfrak{s}</Math> = <Code>[[0,-1],[1,0]]</Code> (under which convention the relations are <Math>\mathfrak{s}^4 = \mathrm{id}</Math>, <Math>(\mathfrak{s}\mathfrak{t})^3 = \mathfrak{s}^2</Math>). When working with that convention, one must invert the <Math>S</Math> matrices output by this package.
<P/>
Throughout, we denote by <Math>\mathbf{e}</Math> the map <Math>k \mapsto e^{2 \pi i k}</Math> (an isomorphism from <Math>\mathbb{Q}/\mathbb{Z}</Math> to the group of finite roots of unity in <Math>\mathbb{C}</Math>).  For a group <Math>G</Math>, we denote by <Math>\widehat{G}</Math> the character group <Math>\operatorname{Hom}(G, \mathbb{C}^\times)</Math>.
<P/>
<Section Label="Chapter_Description_Section_Construction">
<Heading>Construction</Heading>

<P/>
Any representation <Math>\rho</Math> of <Math>\mathrm{SL}_2(\mathbb{Z})</Math> can be decomposed into a direct sum of irreducible representations (irreps). Further, if <Math>\rho</Math> has finite level, each irrep can be factorized into a tensor product of irreps whose levels are powers of distinct primes (using the Chinese remainder theorem). Therefore, to characterize all finite-dimensional representations of <Math>\mathrm{SL}_2(\mathbb{Z})</Math> of finite level, it suffices to consider irreps of <Math>\mathrm{SL}_2(\mathbb{Z}/p^\lambda\mathbb{Z})</Math> for primes <Math>p</Math> and positive integers <Math>\lambda</Math>.
<P/>
<Subsection Label="Chapter_Description_Section_Construction_Subsection_Weil_representations">
<Heading>Weil representations</Heading>

<P/>
Such representations may be constructed using Weil representations as described in <Cite Key="Nobs1" Where="Section 1"/>.  We give a brief summary of the process here.  First, if <Math>M</Math> is any additive abelian group, a <Emph>quadratic form</Emph> on <Math>M</Math> is a map <Math>Q : M \to \mathbb{Q}/\mathbb{Z}</Math> such that
<List>
    <Item><Math>Q(-x) = Q(x)</Math> for all <Math>x \in M</Math>, and</Item>
    <Item><Math>B(x,y) = Q(x+y) - Q(x) - Q(y)</Math> defines a <Math>\mathbb{Z}</Math>-bilinear map <Math>M \times M \to \mathbb{Q}/\mathbb{Z}</Math>.</Item>
</List>
<P/>
Now let <Math>p</Math> be a prime number and <Math>\lambda \in \mathbb{Z}^+</Math>.  Choose a <Math>\mathbb{Z}/p^\lambda\mathbb{Z}</Math>-module <Math>M</Math> and a quadratic form <Math>Q</Math> on <Math>M</Math> such that the pair <Math>(M,Q)</Math> is of one of the three types described in Section <Ref Sect="Chapter_Description_Section_Weil"/>.  Each such <Math>M</Math> is a ring, and has at most 2 cyclic factors as an additive group.  Those with 2 cyclic factors may be identified with a quotient of the quadratic integers, giving a norm on <Math>M</Math>.  Then the <Emph>quadratic module</Emph> <Math>(M,Q)</Math> gives rise to a representation of <Math>\mathrm{SL}_2(\mathbb{Z}/p^\lambda\mathbb{Z})</Math> on the vector space <Math>V = \mathbb{C}^M</Math> of complex-valued functions on <Math>M</Math>.  This representation is denoted <Math>W(M,Q)</Math>.  Note that the <Emph>central charge</Emph> of <Math>(M,Q)</Math> is given by <Math>S_Q(-1) = \frac{1}{\sqrt{|M|}} \sum_{x \in M} \mathbf{e}(Q(x))</Math>.
<P/>
</Subsection>


<Subsection Label="Chapter_Description_Section_Construction_Subsection_Character_subspaces_and_primitive_characters">
<Heading>Character subspaces and primitive characters</Heading>

<P/>
A family of subrepresentations <Math>W(M,Q,\chi)</Math> of <Math>W(M,Q)</Math> may be constructed as follows.  Denote
<Display>\operatorname{Aut}(M,Q) = \{ \varepsilon \in \operatorname{Aut}(M) \mid Q(\varepsilon x) = Q(x) \text{ for all } x \in M\}~.</Display>
We then associate to <Math>(M,Q)</Math> an abelian subgroup <Math>\mathfrak{A} \leq \operatorname{Aut}(M,Q)</Math>; the structure of this group depends on <Math>(M,Q)</Math> and is described in Section <Ref Sect="Chapter_Description_Section_Weil"/>.  Note that <Math>\mathfrak{A}</Math> has at most two cyclic factors, whose generators we denote by <Math>\alpha</Math> and <Math>\beta</Math>.  Now, let <Math>\chi \in \widehat{\mathfrak{A}}</Math> be a 1-dimensional representation (<Emph>character</Emph>) of <Math>\mathfrak{A}</Math>, and define
<Display>V_\chi = \{f \in V \mid f(\varepsilon x) = \chi(\varepsilon) f(x) \text{ for all } x \in M \text{ and } \varepsilon \in \mathfrak{A}\}~,</Display>
which is a <Math>\mathrm{SL}_2(\mathbb{Z}/p^\lambda\mathbb{Z})</Math>-invariant subspace of <Math>V</Math>.  We then denote by <Math>W(M,Q,\chi)</Math> the subrepresentation of <Math>W(M,Q)</Math> on <Math>V_\chi</Math>. Note that <Math>W(M,Q,\chi) \cong W(M,Q,\overline{\chi})</Math>.
<P/>
For the abelian groups <Math>\mathfrak{A} \leq \operatorname{Aut}(M,Q)</Math>, we will frequently refer to a character <Math>\chi \in \widehat{\mathfrak{A}}</Math> as being <Emph>primitive</Emph>.  With the exception of a single family of modules of type <Math>R</Math> (the <Emph>extremal</Emph> case, for which see Section <Ref Sect="Chapter_Description_Section_Weil_Subsection_Type_R_Special"/>), primitivity amounts to the following: there exists some <Math>\varepsilon \in \mathfrak{A}</Math> such that <Math>\chi(\varepsilon) \neq 1</Math> and <Math>\varepsilon</Math> fixes the submodule <Math>pM \subset M</Math> pointwise.  There exists a subgroup <Math>\mathfrak{A}_0 \leq \mathfrak{A}</Math> such that a non-trivial <Math>\chi \in \widehat{\mathfrak{A}}</Math> is primitive if and only if <Math>\chi</Math> is injective on <Math>\mathfrak{A}_0</Math> (or, equivalently, if <Math>\mathfrak{A}_0 \cap \operatorname{ker} \chi</Math> is trivial).
<P/>
Explicit descriptions of the group <Math>\mathfrak{A}_0</Math> for each type are given in Section <Ref Sect="Chapter_Description_Section_Weil"/> and may be used to determine the primitive characters.
<P/>
</Subsection>


<Subsection Label="Chapter_Description_Section_Construction_Subsection_Irrep_Types">
<Heading>Irrep Types</Heading>

<P/>
All irreps of prime-power level and finite degree may then be constructed in one of three ways (<Cite Key="NW76" Where="Hauptsatz 2"/>):
<List>
    <Item>The overwhelming majority are of the form <Math>W(M,Q,\chi)</Math> for <Math>\chi</Math> primitive and <Math>\chi^2 \neq 1</Math>; we call these <Emph>standard</Emph>. This includes the primitive characters from the extremal case.</Item>
    <Item>A finite number, and a single infinite family arising from the extremal case (Section <Ref Sect="Chapter_Description_Section_Weil_Subsection_Type_R_Special"/>), are instead constructed by using non-primitive characters or primitive characters <Math>\chi</Math> with <Math>\chi^2 = 1</Math>.  We call these <Emph>non-standard</Emph>.</Item>
    <Item>Finally, 18 <Emph>exceptional</Emph> irreps are constructed as tensor products of two irreps from the other two cases. A full list of these may be constructed by <Ref Func="SL2IrrepsExceptional"/>.</Item>
</List>
<P/>
</Subsection>


<Subsection Label="Chapter_Description_Section_Construction_Subsection_S_and_T_matrices">
<Heading>S and T matrices</Heading>

<P/>
The images <Math>W(M,Q)(\mathfrak{s})(f)</Math> and <Math>W(M,Q)(\mathfrak{t})(f)</Math> may be calculated for any <Math>f \in V</Math> (see <Cite Key="Nobs1" Where="Satz 2"/>).  Thus, to construct <Math>S</Math> and <Math>T</Math> matrices for the irreducible subrepresentations of <Math>W(M,Q)</Math>, it suffices to find bases for the <Math>W(M,Q)</Math>-invariant subspaces of <Math>V</Math>.  Choices for such bases are given by <Cite Key="NW76"/>; however, these often result in non-symmetric <Math>S</Math> matrices.  It has been proven by the authors of this package that, for all standard and non-standard irreps, there exists a basis for the corresponding subspace of <Math>V</Math> such that <Math>S</Math> is symmetric and unitary and <Math>T</Math> is diagonal (<Cite Key="NWWi"/>, in preparation).  In particular, <Math>S</Math> is always either a real matrix or <Math>i</Math> times a real matrix.  It follows that these properties hold for the exceptional irreps as well.  This package therefore produces matrices with these properties.
<P/>
All the finite-dimensional irreducible representations of <Math>\mathrm{SL}_2(\mathbb{Z})</Math> of finite level can now be constructed by taking tensor products of these prime-power irreps.  Note that, if two representations are determined by pairs <Code>[S1,T1]</Code> and <Code>[S2,T2]</Code>, then the pair for their tensor product may be calculated via the GAP command <Code>KroneckerProduct</Code>, namely as <Code>[KroneckerProduct(S1,S2),KroneckerProduct(T1,T2)]</Code>.
<P/>
</Subsection>


</Section>


<Section Label="Chapter_Description_Section_Weil">
<Heading>Weil representation types</Heading>

<P/>
<Subsection Label="Chapter_Description_Section_Weil_Subsection_Type_D">
<Heading>Type D</Heading>

<P/>
Let <Math>p</Math> be prime.  If <Math>p=2</Math> or <Math>p=3</Math>, let <Math>\lambda \geq 2</Math>; otherwise, let <Math>\lambda \geq 1</Math>.  Then the Weil representation arising from the quadratic module with <Display>M = \mathbb{Z}/p^\lambda\mathbb{Z} \oplus \mathbb{Z}/p^\lambda\mathbb{Z} \qquad \text{and} \qquad Q(x,y) = \frac{xy}{p^\lambda}</Display> is said to be of type <Math>D</Math> and denoted <Math>D(p,\lambda)</Math>.  Information on type <Math>D</Math> quadratic modules may be obtained via <Ref Func="SL2ModuleD"/>, and subrepresentations of <Math>D(p,\lambda)</Math> with level <Math>p^\lambda</Math> may be constructed via <Ref Func="SL2IrrepD"/>.
<P/>
The group
<Display>\mathfrak{A} \cong (\mathbb{Z}/p^\lambda\mathbb{Z})^\times</Display>
acts on <Math>M</Math> by <Math>a(x,y) = (a^{-1}x, ay)</Math> and is thus identified with a subgroup of <Math>\operatorname{Aut}(M,Q)</Math>; see <Cite Key="NW76" Where="Section 2.1"/>. The group <Math>\mathfrak{A}</Math> has order <Math>p^{\lambda-1}(p-1)</Math> and <Math>\mathfrak{A} = \langle\alpha\rangle \times \langle\beta\rangle</Math>.  The relevant information for type <Math>D</Math> quadratic modules is as follows:
<Table Align="ccccc">
    <Row>
        <Item><Math>p</Math></Item>
        <Item><Math>\lambda</Math></Item>
        <Item><Math>\alpha</Math></Item>
        <Item><Math>\beta</Math></Item>
        <Item><Math>\mathfrak{A}_0</Math></Item>
    </Row>
    <HorLine/>
    <Row>
        <Item><Math>>2</Math></Item>
        <Item><Math>1</Math></Item>
        <Item><Math>1</Math></Item>
        <Item><Math>|\beta| = p-1</Math></Item>
        <Item><Math>\langle 1 \rangle</Math></Item>
    </Row>
    <Row>
        <Item><Math>>2</Math></Item>
        <Item><Math>>1</Math></Item>
        <Item><Math>|\alpha| = p^{\lambda-1}</Math> (e.g. <Math>\alpha = 1 + p</Math>)</Item>
        <Item><Math>|\beta| = p-1</Math></Item>
        <Item><Math>\langle \alpha \rangle</Math></Item>
    </Row>
    <Row>
        <Item><Math>2</Math></Item>
        <Item><Math>2</Math></Item>
        <Item><Math>1</Math></Item>
        <Item><Math>-1</Math></Item>
        <Item><Math>\langle 1 \rangle</Math></Item>
    </Row>
    <Row>
        <Item><Math>2</Math></Item>
        <Item><Math>>2</Math></Item>
        <Item><Math>|\alpha| = 2^{\lambda-2}</Math> (e.g. <Math>\alpha = 5</Math>)</Item>
        <Item><Math>-1</Math></Item>
        <Item><Math>\langle \alpha \rangle</Math></Item>
    </Row>
</Table>
When <Math>\mathfrak{A}_0</Math> is trivial, every non-trivial character <Math>\chi \in \widehat{\mathfrak{A}}</Math> is primitive.
<P/>
</Subsection>


<Subsection Label="Chapter_Description_Section_Weil_Subsection_Type_N">
<Heading>Type N</Heading>

<P/>
Let <Math>p</Math> be prime and <Math>\lambda \geq 1</Math>. If <Math>p \neq 2</Math>, let <Math>u</Math> be a positive integer so that <Math>u \equiv 3</Math> mod 4 with <Math>-u</Math> a quadratic non-residue mod <Math>p</Math>; if <Math>p = 2</Math>, let <Math>u=3</Math>.  Then the Weil representation arising from the quadratic module with <Display>M = \mathbb{Z}/p^\lambda\mathbb{Z} \oplus \mathbb{Z}/p^\lambda\mathbb{Z} \qquad \text{and} \qquad Q(x,y) = \frac{x^2 +xy+\frac{1+u}{4}y^2}{p^\lambda}</Display> is said to be of type <Math>N</Math> and denoted <Math>N(p,\lambda)</Math>.  Information on type <Math>N</Math> quadratic modules may be obtained via <Ref Func="SL2ModuleN"/>, and subrepresentations of <Math>N(p,\lambda)</Math> with level <Math>p^\lambda</Math> may be constructed via <Ref Func="SL2IrrepN"/>.
<P/>
The additive group <Math>M</Math> is a ring with multiplication given by
<Display>(x_1, y_1) \cdot (x_2, y_2) = (x_1x_2 - \frac{1+u}{4}y_1y_2, x_1y_2 + x_2y_1 + y_1y_2)</Display>
and identity element <Math>(1,0)</Math>.  We define a norm <Math>\operatorname{Nm}(x,y) = x^2 + xy + \frac{1+u}{4}y^2</Math> on <Math>M</Math>; then the multiplicative subgroup
<Display>\mathfrak{A} = \{\varepsilon \in M^\times \mid \operatorname{Nm}(\varepsilon) = 1 \}</Display>
of <Math>M^\times</Math> acts on <Math>M</Math> by multiplication and is identified with a subgroup of <Math>\operatorname{Aut}(M,Q)</Math>; see <Cite Key="NW76" Where="Section 2.2"/>.
<P/>
The group <Math>\mathfrak{A}</Math> has order <Math>p^{\lambda-1}(p+1)</Math> and <Math>\mathfrak{A} = \langle \alpha \rangle \times \langle \beta \rangle</Math>.  The relevant information for type <Math>N</Math> quadratic modules is as follows:
<Table Align="ccccc">
    <Row>
        <Item><Math>p</Math></Item>
        <Item><Math>\lambda</Math></Item>
        <Item><Math>\alpha</Math></Item>
        <Item><Math>\beta</Math></Item>
        <Item><Math>\mathfrak{A}_0</Math></Item>
    </Row>
    <HorLine/>
    <Row>
        <Item><Math>>2</Math></Item>
        <Item><Math>1</Math></Item>
        <Item><Math>(1,0)</Math></Item>
        <Item><Math>|\beta| = p+1</Math></Item>
        <Item><Math>\langle (1,0) \rangle</Math></Item>
    </Row>
    <Row>
        <Item><Math>>2</Math></Item>
        <Item><Math>>1</Math></Item>
        <Item><Math>|\alpha| = p^{\lambda-1}</Math></Item>
        <Item><Math>|\beta| = p+1</Math></Item>
        <Item><Math>\langle \alpha \rangle</Math></Item>
    </Row>
    <Row>
        <Item><Math>2</Math></Item>
        <Item><Math>1</Math></Item>
        <Item><Math>(1,0)</Math></Item>
        <Item><Math>|\beta| = 3</Math></Item>
        <Item><Math>\langle (1,0) \rangle</Math></Item>
    </Row>
    <Row>
        <Item><Math>2</Math></Item>
        <Item><Math>2</Math></Item>
        <Item><Math>(1,0)</Math></Item>
        <Item><Math>|\beta| = 6</Math></Item>
        <Item><Math>\langle (-1,0) \rangle</Math></Item>
    </Row>
    <Row>
        <Item><Math>2</Math></Item>
        <Item><Math>>2</Math></Item>
        <Item><Math>|\alpha| = p^{\lambda-2}</Math></Item>
        <Item><Math>|\beta| = 6</Math></Item>
        <Item><Math>\langle \alpha \rangle</Math></Item>
    </Row>
</Table>
When <Math>\mathfrak{A}_0</Math> is trivial, every non-trivial character <Math>\chi \in \widehat{\mathfrak{A}}</Math> is primitive.
<P/>
</Subsection>


<Subsection Label="Chapter_Description_Section_Weil_Subsection_Type_R">
<Heading>Type R, generic cases</Heading>

<P/>
The structure of the quadratic module <Math>(M,Q)</Math> of type <Math>R</Math> depends upon three additional parameters: <Math>\sigma</Math>, <Math>r</Math>, and <Math>t</Math>. Details are as follows:
<P/>
<List>
    <Item>If <Math>p</Math> is odd, let <Math>\lambda \geq 2</Math>, <Math>\sigma \in \{1, \dots, \lambda\}</Math>, and <Math>r,t \in \{1,u\}</Math> with <Math>u</Math> a quadratic non-residue mod <Math>p</Math>.  Then define <Display>M = \mathbb{Z}/p^\lambda\mathbb{Z} \oplus \mathbb{Z}/p^{\lambda-\sigma}\mathbb{Z} \qquad \text{and} \qquad Q(x,y) = \frac{r(x^2 + p^\sigma t y^2)}{p^\lambda}~.</Display>
    When <Math>\sigma = \lambda</Math>, the second factor of <Math>M</Math> is trivial, and <Math>(M,Q)</Math> is said to be in the <Emph>unary</Emph> family; otherwise, it is called <Emph>generic</Emph>.</Item>
    <Item>If <Math>p=2</Math>, let <Math>\lambda \geq 2</Math>, <Math>\sigma \in \{0, \dots, \lambda-2\}</Math> and <Math>r,t \in \{1,3,5,7\}</Math>. Then define <Display>M = \mathbb{Z}/2^{\lambda-1}\mathbb{Z} \oplus \mathbb{Z}/2^{\lambda-\sigma-1}\mathbb{Z} \qquad \text{and} \qquad Q(x,y) = \frac{r(x^2 + 2^\sigma t y^2)}{2^\lambda}~.</Display>
    When <Math>\sigma = \lambda - 2</Math>, the second factor of <Math>M</Math> is isomorphic to <Math>\mathbb{Z}/2\mathbb{Z}</Math>, and <Math>(M,Q)</Math> is said to be in the <Emph>extremal</Emph> family; otherwise, it is called <Emph>generic</Emph>.</Item>
</List>
<P/>
In all cases, the resulting representation is said to be of type <Math>R</Math> and denoted <Math>R(p,\lambda,\sigma,r,t)</Math>.  The additive group <Math>M</Math> admits a ring structure with multiplication
<Display>(x_1, y_1) \cdot (x_2, y_2) = (x_1x_2 - p^\sigma ty_1y_2, x_1y_2 + x_2y_1)</Display>
and identity element <Math>(1,0)</Math>. We define a norm <Math>\operatorname{Nm}(x,y) = x^2 + xy + p^\sigma t y^2</Math> on <Math>M</Math>.
<P/>
In this section, we detail generic type <Math>R</Math> quadratic modules. Information on the unary and extremal cases is covered in Section <Ref Sect="Chapter_Description_Section_Weil_Subsection_Type_R_Special"/>.
<P/>
Let <Math>(M,Q)</Math> be a generic type <Math>R</Math> quadratic module.  Information on <Math>(M,Q)</Math> can be obtained via <Ref Func="SL2ModuleR"/>, and subrepresentations of <Math>R(p,\lambda,\sigma,r,t)</Math> with level <Math>p^\lambda</Math> may be constructed via <Ref Func="SL2IrrepR"/>.
<P/>
The multiplicative subgroup
<Display>\mathfrak{A} = \{\varepsilon \in M^\times \mid \operatorname{Nm}(\varepsilon) = 1 \}</Display>
of <Math>M^\times</Math> acts on <Math>M</Math> by multiplication and is identified with a subgroup of <Math>\operatorname{Aut}(M,Q)</Math>; see <Cite Key="NW76" Where="Section 2.3 - 2.4"/>.  The relevant information is as follows:
<List>
    <Item>If <Math>p</Math> is odd, <Math>\mathfrak{A} = \langle\alpha\rangle \times \langle\beta\rangle</Math> with order <Math>2p^{\lambda-\sigma}</Math>.  In this case, for fixed <Math>p</Math>, <Math>\lambda</Math>, <Math>\sigma</Math>, each pair <Math>(r,t)</Math> gives rise to a distinct quadratic module <Cite Key="Nobs1" Where="Satz 4"/>.  The following table covers a complete list of representatives of equivalence classes of such modules.
    <Table Align="ccccccc">
        <Row>
            <Item><Math>p</Math></Item>
            <Item><Math>\lambda</Math></Item>
            <Item><Math>\sigma</Math></Item>
            <Item><Math>(r,t)</Math></Item>
            <Item><Math>\alpha</Math></Item>
            <Item><Math>\beta</Math></Item>
            <Item><Math>\mathfrak{A}_0</Math></Item>
        </Row>
        <HorLine/>
        <Row>
            <Item><Math>3</Math></Item>
            <Item><Math>2</Math></Item>
            <Item><Math>1</Math></Item>
            <Item><Math>r,t \in \{1,2\}</Math></Item>
            <Item><Math>|\alpha| = 3</Math></Item>
            <Item><Math>(-1,0)</Math></Item>
            <Item><Math>\langle \alpha \rangle</Math></Item>
        </Row>
        <Row>
            <Item><Math>3</Math></Item>
            <Item><Math>\geq 3</Math></Item>
            <Item><Math>1</Math></Item>
            <Item><Math>t=1</Math>, <Math>r \in \{1,2\}</Math></Item>
            <Item><Math>|\alpha| = 3^{\lambda-\sigma-1}</Math></Item>
            <Item><Math>|\beta| = 6</Math></Item>
            <Item><Math>\langle \alpha \rangle</Math></Item>
        </Row>
        <Row>
            <Item><Math>3</Math></Item>
            <Item><Math>\geq 3</Math></Item>
            <Item><Math>1</Math></Item>
            <Item><Math>t=2</Math>, <Math>r \in \{1,2\}</Math></Item>
            <Item><Math>|\alpha| = 3^{\lambda-\sigma}</Math></Item>
            <Item><Math>(-1,0)</Math></Item>
            <Item><Math>\langle \alpha \rangle</Math></Item>
        </Row>
        <Row>
            <Item><Math>3</Math></Item>
            <Item><Math>\geq 3</Math></Item>
            <Item><Math>2,\dots,\lambda-1</Math></Item>
            <Item><Math>r,t \in \{1,2\}</Math></Item>
            <Item><Math>|\alpha| = 3^{\lambda-\sigma}</Math></Item>
            <Item><Math>(-1,0)</Math></Item>
            <Item><Math>\langle \alpha \rangle</Math></Item>
        </Row>
        <Row>
            <Item><Math>\geq 5</Math></Item>
            <Item><Math>\geq 2</Math></Item>
            <Item><Math>1, \dots,\lambda - 1</Math></Item>
            <Item><Math>r,t \in \{1,u\}</Math></Item>
            <Item><Math>|\alpha| = p^{\lambda-\sigma}</Math></Item>
            <Item><Math>(-1,0)</Math></Item>
            <Item><Math>\langle \alpha \rangle</Math></Item>
        </Row>
    </Table></Item>
    <Item>If <Math>p=2</Math>, then the generic case occurs when <Math>\lambda \geq 3</Math> and <Math>\sigma \in \{0,\dots,\lambda-3\}</Math>. Again, <Math>\mathfrak{A} = \langle\alpha\rangle \times \langle\beta\rangle</Math>; the order is <Math>2^{\lambda-\sigma-k}</Math> with <Math>k \in \{0,1,2\}</Math> (as specified below).  In this case, for fixed <Math>p</Math>, <Math>\lambda</Math>, <Math>\sigma</Math>, two pairs <Math>(r_1,t_1)</Math> and <Math>(r_2,t_2)</Math> may give rise to equivalent quadratic modules <Cite Key="Nobs1" Where="Satz 4"/>.  The following table covers a complete list of representatives of equivalence classes of such modules.
    <Table Align="ccccccc">
        <Row>
            <Item><Math>\lambda</Math></Item>
            <Item><Math>\sigma</Math></Item>
            <Item><Math>r</Math></Item>
            <Item><Math>t</Math></Item>
            <Item><Math>\alpha = (x,y)</Math></Item>
            <Item><Math>\beta</Math></Item>
            <Item><Math>\mathfrak{A}_0</Math></Item>
        </Row>
        <HorLine/>
        <Row>
            <Item><Math>3</Math></Item>
            <Item><Math>0</Math></Item>
            <Item><Math>1,3</Math></Item>
            <Item><Math>1,5</Math></Item>
            <Item><Math>(1,0)</Math></Item>
            <Item><Math>(\frac{t-1}{2},1)</Math></Item>
            <Item><Math>\langle (-1,0) \rangle</Math></Item>
        </Row>
        <Row>
            <Item><Math>3</Math></Item>
            <Item><Math>0</Math></Item>
            <Item><Math>1</Math></Item>
            <Item><Math>3,7</Math></Item>
            <Item><Math>(1,0)</Math></Item>
            <Item><Math>(-1,0)</Math></Item>
            <Item><Math>\langle (-1,0) \rangle</Math></Item>
        </Row>
        <Row>
            <Item><Math>4</Math></Item>
            <Item><Math>0</Math></Item>
            <Item><Math>1,3</Math></Item>
            <Item><Math>5</Math></Item>
            <Item><Math>x=2, y \equiv 3 \operatorname{mod} 4, |\alpha| = 2^{\lambda-2}</Math></Item>
            <Item><Math>(-1,0)</Math></Item>
            <Item><Math>\langle -\alpha^2 \rangle</Math></Item>
        </Row>
        <Row>
            <Item><Math>\geq 4</Math></Item>
            <Item><Math>0</Math></Item>
            <Item><Math>1,3</Math></Item>
            <Item><Math>1</Math></Item>
            <Item><Math>x \equiv 1 \operatorname{mod} 4, y = 4, |\alpha| = 2^{\lambda-3}</Math></Item>
            <Item><Math>(0,1)</Math></Item>
            <Item><Math>\langle \alpha \rangle</Math></Item>
        </Row>
        <Row>
            <Item><Math>\geq 4</Math></Item>
            <Item><Math>0</Math></Item>
            <Item><Math>1</Math></Item>
            <Item><Math>3,7</Math></Item>
            <Item><Math>x \equiv 1 \operatorname{mod} 4, y = 4, |\alpha| = 2^{\lambda-3}</Math></Item>
            <Item><Math>(-1,0)</Math></Item>
            <Item><Math>\langle \alpha \rangle</Math></Item>
        </Row>
        <Row>
            <Item><Math>\geq 5</Math></Item>
            <Item><Math>0</Math></Item>
            <Item><Math>1,3</Math></Item>
            <Item><Math>5</Math></Item>
            <Item><Math>x=2, y \equiv 3 \operatorname{mod} 4, |\alpha| = 2^{\lambda-2}</Math></Item>
            <Item><Math>(-1,0)</Math></Item>
            <Item><Math>\langle \alpha \rangle</Math></Item>
        </Row>
        <Row>
            <Item><Math>\geq 3</Math></Item>
            <Item><Math>1,2</Math></Item>
            <Item><Math>1,3,5,7</Math></Item>
            <Item><Math>1,3,5,7</Math></Item>
            <Item><Math>x\equiv 1 \operatorname{mod} 4, y=2, |\alpha| = 2^{\lambda-\sigma-2}</Math></Item>
            <Item><Math>(-1,0)</Math></Item>
            <Item><Math>\langle \alpha \rangle</Math></Item>
        </Row>
        <Row>
            <Item><Math>\geq 3</Math></Item>
            <Item><Math>\geq 3</Math></Item>
            <Item><Math>1,3,5,7</Math></Item>
            <Item><Math>1,3,5,7</Math></Item>
            <Item><Math>x\equiv 1 \operatorname{mod} 4, y=1, |\alpha| = 2^{\lambda-\sigma-1}</Math></Item>
            <Item><Math>(-1,0)</Math></Item>
            <Item><Math>\langle \alpha \rangle</Math></Item>
        </Row>
    </Table></Item>
</List>
<P/>
</Subsection>


<Subsection Label="Chapter_Description_Section_Weil_Subsection_Type_R_Special">
<Heading>Type R, unary and extremal cases</Heading>

<P/>
This section covers the unary and extremal cases of type <Math>R</Math>.
<P/>
First, in the unary family, we have <Math>p</Math> odd and <Math>\sigma = \lambda</Math>.  Then the second factor of <Math>M</Math> is trivial (and hence <Math>t</Math> is irrelevant).  We then denote <Math>R_{p^\lambda}(r) = R(p,\lambda,\lambda,r,t)</Math>.  In this case, we do not decompose <Math>W(M,Q)</Math> using characters: instead, if <Math>\lambda \leq 2</Math>, then <Math>W(M,Q)</Math> contains two distinct irreducible subrepresentations of level <Math>p^\lambda</Math>, denoted <Math>R_{p^\lambda}(r)_{\pm}</Math>; otherwise, it contains a single such subrepresentation, denoted <Math>R_{p^\lambda}(r)_1</Math>.  The unary family is handled by <Ref Func="SL2IrrepRUnary"/> (which is called by <Ref Func="SL2IrrepR"/> when appropriate).
<P/>
Second, in the extremal family, we have <Math>p=2</Math>, <Math>\lambda \geq 2</Math>, and <Math>\sigma = \lambda - 2</Math>.  Then the second factor of <Math>M</Math> is isomorphic to <Math>\mathbb{Z}/2\mathbb{Z}</Math>, and collapses in <Math>2M</Math>.  Here, <Math>\operatorname{Aut}(M,Q)</Math> is itself abelian, so we let <Math>\mathfrak{A} = \operatorname{Aut}(M,Q)</Math>. This group has order 1, 2, or 4, with the following structure:
<List>
    <Item>For <Math>\lambda = 2</Math> and <Math>t=1</Math>, <Math>\mathfrak{A} = \langle \tau \rangle</Math> where <Math>\tau : (x,y) \mapsto (y,x)</Math>, and <Math>\mathfrak{A}_0 = \mathfrak{A} = \langle\tau\rangle</Math>.</Item>
    <Item>For <Math>\lambda = 2</Math> and <Math>t = 3</Math>, <Math>\mathfrak{A}</Math> is trivial; there are no primitive characters.</Item>
    <Item>For <Math>\lambda = 3</Math> or <Math>4</Math>, <Math>\mathfrak{A} = \{\pm 1\}</Math> acting on <Math>M</Math> by multiplication; there are no primitive characters.</Item>
    <Item>Finally, for <Math>\lambda \geq 5</Math>, <Math>\mathfrak{A} = \operatorname{Aut}(M,Q) = \langle \alpha \rangle \times \langle -1 \rangle</Math> with <Math>\alpha</Math> of order 2, and <Math>\mathfrak{A}_0 = \langle\alpha\rangle</Math>. Note that, for this special case, the usual test for primitivity (described in Section <Ref Sect="Chapter_Description_Section_Construction"/>) fails, as there are no elements of <Math>\mathfrak{A}</Math> fixing <Math>2M</Math> pointwise.</Item>
</List>
The extremal family is handled by <Ref Func="SL2ModuleR"/> and <Ref Func="SL2IrrepR"/>, just like the generic case.
<P/>
</Subsection>


</Section>


</Chapter>

